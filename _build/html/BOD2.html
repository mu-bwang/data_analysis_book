
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Water quality modeling - BOD in rivers (II) &#8212; Data Analysis in Water Resource Engineering</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Spectral analysis of river discharge data" href="river_spectra.html" />
    <link rel="prev" title="Water quality modeling - BOD in rivers (I)" href="BOD1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Analysis in Water Resource Engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    About the book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="howto.html">
   How to use this book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="particle_settling1.html">
   Particle Settling in Water (I)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="particle_settling2.html">
   Particle Settling in Water (II)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rating_curve.html">
   Rating curve for stream discharge and hydrographs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BOD1.html">
   Water quality modeling - BOD in rivers (I)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Water quality modeling - BOD in rivers (II)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="river_spectra.html">
   Spectral analysis of river discharge data
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/BOD2.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FBOD2.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/BOD2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/BOD2.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bod-do-deficit-equations">
   BOD-DO deficit equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-bod-equation">
   Solving BOD equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concurrently-solving-bod-and-do-deficit-equations">
   Concurrently solving BOD and DO deficit equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#take-home-work">
   Take-home work
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Water quality modeling - BOD in rivers (II)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bod-do-deficit-equations">
   BOD-DO deficit equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-bod-equation">
   Solving BOD equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concurrently-solving-bod-and-do-deficit-equations">
   Concurrently solving BOD and DO deficit equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#take-home-work">
   Take-home work
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="water-quality-modeling-bod-in-rivers-ii">
<h1>Water quality modeling - BOD in rivers (II)<a class="headerlink" href="#water-quality-modeling-bod-in-rivers-ii" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>We have shown in <a class="reference internal" href="BOD1.html"><span class="doc std std-doc">BOD in rivers (I)</span></a> that Streeter-Phelps equation explains how DO concentration varies in steady-state rivers controlled by deoxygenation, reaeration, and advection due to river flow. However, Streeter-Phelps equation does not consider other mixing processes (e.g., dispersion), so that the upstream water are not affected by the point source pollution. Apparently this is not true in reality. In this lab, we will explore this additional mixing process and how they affect DO and BOD in the stream.</p>
</section>
<section id="bod-do-deficit-equations">
<h2>BOD-DO deficit equations<a class="headerlink" href="#bod-do-deficit-equations" title="Permalink to this headline">#</a></h2>
<p>The advection-diffusion process of DO and BOD variation is controlled by a set of partial differential equations (PDE), which can be simplified to be a set of second-order ordinary differential equations (ODE):</p>
<div class="math notranslate nohighlight" id="equation-gov1">
<span class="eqno">(13)<a class="headerlink" href="#equation-gov1" title="Permalink to this equation">#</a></span>\[E\frac{d^2 L}{dx^2} - u\frac{dL}{dx} - k_d L = 0\]</div>
<div class="math notranslate nohighlight" id="equation-gov2">
<span class="eqno">(14)<a class="headerlink" href="#equation-gov2" title="Permalink to this equation">#</a></span>\[E\frac{d^2 D}{dx^2} - u\frac{dD}{dx} - k_a D + K_d L = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(E\)</span> is longitudinal dispersion coefficient.</p>
<p>Some other important parameters in this system include: river discharge <span class="math notranslate nohighlight">\(Q\)</span>, mass discharge in wastewater (pollutant source) <span class="math notranslate nohighlight">\(W\)</span>, BOD concentration at the source <span class="math notranslate nohighlight">\(L_0\)</span>. They are connected through this equation:</p>
<div class="math notranslate nohighlight" id="equation-l0">
<span class="eqno">(15)<a class="headerlink" href="#equation-l0" title="Permalink to this equation">#</a></span>\[L_0 = \frac{W}{Qm_1}\]</div>
<p>with <span class="math notranslate nohighlight">\(m_1 = \sqrt{1+\frac{4k_d E}{u^2}}\)</span>.</p>
</section>
<section id="solving-bod-equation">
<h2>Solving BOD equation<a class="headerlink" href="#solving-bod-equation" title="Permalink to this headline">#</a></h2>
<p>Let’s work on an example of wastewater BOD discharge into a coastal plain estuary (Example 6.7 in Book “Environmental Modeling: fate and transport of pollutants in water, air, and soil” authored by Dr. Jerald L. Schnoor).</p>
<p>Here is the list of parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\)</span> = 15 mi<span class="math notranslate nohighlight">\(^2\)</span>/day (dispersion coefficient)</p></li>
<li><p><span class="math notranslate nohighlight">\(k_d\)</span> = 0.15 /day (deoxygenation rate)</p></li>
<li><p><span class="math notranslate nohighlight">\(k_a\)</span> = 0.18 /day (reaeration rate)</p></li>
<li><p><span class="math notranslate nohighlight">\(u\)</span> = 3.57 mi/day (mean tidal velocity)</p></li>
<li><p><span class="math notranslate nohighlight">\(W/Q\)</span> = 18.5 mg/L (wastewater mass discharge / flow discharge)</p></li>
</ul>
<p>To find out the relationship between BOD concentration and location (<span class="math notranslate nohighlight">\(L\)</span> vs. <span class="math notranslate nohighlight">\(x\)</span>) at both upstream and downstream of the source (<span class="math notranslate nohighlight">\(-10\)</span> mi <span class="math notranslate nohighlight">\(&lt; x &lt; 50\)</span> mi), we will need to solve Eq. <a class="reference internal" href="#equation-gov1">(13)</a> with the following boundary condition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}L = \begin{cases}
	0 &amp; \textrm{for } x=-\infty \\
  L_0 &amp; \textrm{for } x=0 \\
  0 &amp; \textrm{for } x=\infty
  \end{cases}\end{split}\]</div>
<p>We will use <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_bvp</span></code> to solve this boundary value problem (BVP). Here we have some incomplete instructions to get it started. However, you still need to google it to find out how to use <code class="docutils literal notranslate"><span class="pre">solve_bvp</span></code>.</p>
<p>Since we have a second-order ODE Eq. <a class="reference internal" href="#equation-gov1">(13)</a> for <span class="math notranslate nohighlight">\(L\)</span>, we can rewrite the second-order ODE to two first-order ODEs:</p>
<div class="math notranslate nohighlight">
\[\frac{dL}{dx} = L_1\]</div>
<div class="math notranslate nohighlight">
\[\frac{dL_1}{dx}  = \frac{uL_1 + k_d L}{E}\]</div>
<p>Here is how you can define these two equations in Python (this function return <code class="docutils literal notranslate"><span class="pre">dydt</span></code> with first dimension is <span class="math notranslate nohighlight">\(dL/dx\)</span>, and the second dimension is <span class="math notranslate nohighlight">\(dL_1/dx\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">L_eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">L</span><span class="p">,</span> <span class="n">L1</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">L1</span><span class="p">,</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">L1</span> <span class="o">+</span> <span class="n">kd</span><span class="o">*</span><span class="n">L</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dydt</span>
</pre></div>
</div>
</div>
</div>
<p>We need to solve this problem twice (upstream and downstream) since we have two boundary conditions for <span class="math notranslate nohighlight">\(x&gt;0\)</span> and <span class="math notranslate nohighlight">\(x&lt;0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bc1</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">L0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">bc2</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">L0</span><span class="p">,</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>The first boundary condition <code class="docutils literal notranslate"><span class="pre">bc1</span></code> is for <span class="math notranslate nohighlight">\(x&lt;0\)</span> and <code class="docutils literal notranslate"><span class="pre">bc2</span></code> is for <span class="math notranslate nohighlight">\(x&gt;0\)</span>. You may see <span class="math notranslate nohighlight">\(L_0\)</span> in the second term of <code class="docutils literal notranslate"><span class="pre">bc1</span></code> and in the first term of <code class="docutils literal notranslate"><span class="pre">bc2</span></code>. They are the source locations which represent the right hand side boundary for <span class="math notranslate nohighlight">\(x&lt;0\)</span> and the left hand side boundary for <span class="math notranslate nohighlight">\(x&gt;0\)</span>.</p>
<div class="admonition-in-class-exercise admonition">
<p class="admonition-title">In-class exercise</p>
<p>Write your own program to solve this problem with the help of the above given codes.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Since we can not define infinity in the program, let’s select <span class="math notranslate nohighlight">\(-100\)</span> miles and 500 miles as upstream and downstream infinity locations where the pollution from wastewater can not be detected (You can later change the left and right boundary and re-run your program to verify whether these values make sense).</p>
<p>Plot the BOD concentration as a function of <span class="math notranslate nohighlight">\(x\)</span> with x-axis limit of <span class="math notranslate nohighlight">\(-10 \sim 50\)</span> miles. Compare your plots with analytical solution (<span class="math notranslate nohighlight">\(+\)</span> and <span class="math notranslate nohighlight">\(-\)</span> are for <span class="math notranslate nohighlight">\(x&lt;0\)</span> and <span class="math notranslate nohighlight">\(&gt;0\)</span>, respectively):</p>
<div class="math notranslate nohighlight">
\[L = L_0 \exp\left(\frac{u x}{2E} (1\pm m_1) \right)\]</div>
</div>
</div>
</section>
<section id="concurrently-solving-bod-and-do-deficit-equations">
<h2>Concurrently solving BOD and DO deficit equations<a class="headerlink" href="#concurrently-solving-bod-and-do-deficit-equations" title="Permalink to this headline">#</a></h2>
<p>To solve both BOD and DO deficit equations concurrently, we need to solve a set of four first order equations:</p>
<div class="math notranslate nohighlight">
\[\frac{dL}{dx} = L_1\]</div>
<div class="math notranslate nohighlight">
\[\frac{dL_1}{dx}  = \frac{uL_1 + k_d L}{E}\]</div>
<div class="math notranslate nohighlight">
\[\frac{dD}{dx} = D_1\]</div>
<div class="math notranslate nohighlight">
\[\frac{dD_1}{dx}  = \frac{uD_1 + k_a D - K_d L}{E}\]</div>
</section>
<section id="take-home-work">
<h2>Take-home work<a class="headerlink" href="#take-home-work" title="Permalink to this headline">#</a></h2>
<p>In this lab, we will solve above equations using <code class="docutils literal notranslate"><span class="pre">solve_bvp</span></code>, similar to what we did for BOD equation only. We will use the same parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E\)</span> = 15 mi<span class="math notranslate nohighlight">\(^2\)</span>/day (dispersion coefficient)</p></li>
<li><p><span class="math notranslate nohighlight">\(k_d\)</span> = 0.15 /day (deoxygenation rate)</p></li>
<li><p><span class="math notranslate nohighlight">\(k_a\)</span> = 0.18 /day (reaeration rate)</p></li>
<li><p><span class="math notranslate nohighlight">\(u\)</span> = 3.57 mi/day (mean tidal velocity)</p></li>
<li><p><span class="math notranslate nohighlight">\(W/Q\)</span> = 18.5 mg/L (wastewater mass discharge / flow discharge)</p></li>
</ul>
<p>To help you start, there are several key steps you need to work out:</p>
<p><strong>step 1:</strong></p>
<p>Refer to <code class="docutils literal notranslate"><span class="pre">L_eq(x,y)</span></code>, define a new function for BOD and DO deficit equations.</p>
<p><strong>step 2:</strong></p>
<p>Use two sets of boundary conditions in your program:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bc3</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">L0</span><span class="p">,</span> <span class="n">ya</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">yb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">D0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">bc4</span><span class="p">(</span><span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ya</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">L0</span><span class="p">,</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ya</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">D0</span><span class="p">,</span> <span class="n">yb</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>You will need to define <span class="math notranslate nohighlight">\(D_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[D_0  = \frac{k_d W}{(k_a-k_d)Q}\left(\frac{1}{m_1}-\frac{1}{m_2}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(m_2 = \sqrt{1+\frac{4k_a E}{u^2}}\)</span></p>
<p><strong>step 3:</strong></p>
<p>After you solve the problem, plot BOD vs. <span class="math notranslate nohighlight">\(x\)</span> and DO deficit vs. <span class="math notranslate nohighlight">\(x\)</span> on the same figure. Also plot the analytical solutions for comparison:</p>
<div class="math notranslate nohighlight">
\[L = L_0 \exp\left(\frac{u x}{2E} (1\pm m_1) \right)\]</div>
<div class="math notranslate nohighlight">
\[D  = \frac{k_d W}{(k_a-k_d)Q}\left(\frac{1}{m_1} \exp \left[ \frac{u x}{2 E} (1\pm m_1) \right] - \frac{1}{m_2}\exp \left[\frac{u x}{2 E} (1\pm m_2)\right]\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(+\)</span> and <span class="math notranslate nohighlight">\(-\)</span> are for <span class="math notranslate nohighlight">\(x&lt;0\)</span> and <span class="math notranslate nohighlight">\(&gt;0\)</span>, respectively.</p>
<p><strong>step 4:</strong></p>
<p>Label your <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> axes with variable names and their correct units, and add legend on the figure (i.e., BOD analytical, BOD model, DO deficit analytical, DO model).</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="BOD1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Water quality modeling - BOD in rivers (I)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="river_spectra.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spectral analysis of river discharge data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Binbin Wang<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>